<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Dark Theme CSS -->
<style>
    :root {
        --bg-color: #1a1a1a;
        --card-bg: #2d2d2d;
        --text-color: #f8f9fa;
        --text-muted: #adb5bd;
        --border-color: #444;
        --primary-color: #7b2cbf;
        --secondary-color: #6c757d;
        --success-color: #28a745;
        --info-color: #17a2b8;
        --warning-color: #ffc107;
        --danger-color: #dc3545;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-color);
    }

    .card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        color: var(--text-color);
    }

    .card-header {
        background-color: rgba(0, 0, 0, 0.2);
        border-bottom: 1px solid var(--border-color);
    }

    .table {
        color: var(--text-color);
    }

    .table-hover tbody tr:hover {
        background-color: rgba(255, 255, 255, 0.05);
    }

    .form-control, .form-select {
        background-color: #2d2d2d;
        border: 1px solid #444;
        color: #f8f9fa;
    }

    .form-control:focus, .form-select:focus {
        background-color: #3d3d3d;
        color: #fff;
        border-color: #7b2cbf;
        box-shadow: 0 0 0 0.25rem rgba(123, 44, 191, 0.25);
    }

    .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
    }

    .btn-primary:hover {
        background-color: #6a1b9a;
        border-color: #6a1b9a;
    }

    .bg-light {
        background-color: #2d2d2d !important;
    }

    .text-muted {
        color: var(--text-muted) !important;
    }

    .border-bottom {
        border-bottom: 1px solid var(--border-color) !important;
    }

    /* Navbar styles */
    .navbar {
        background-color: #1a1a1a !important;
        border-bottom: 1px solid var(--border-color);
    }

    .navbar-brand, .nav-link {
        color: var(--text-color) !important;
    }

    .nav-link:hover {
        color: var(--primary-color) !important;
    }

    /* Sidebar styles */
    .sidebar {
        background-color: #1a1a1a;
        border-right: 1px solid var(--border-color);
    }

    .sidebar .nav-link {
        color: var(--text-muted);
        padding: 0.5rem 1rem;
        margin: 0.2rem 0;
        border-radius: 0.25rem;
    }

    .sidebar .nav-link:hover, .sidebar .nav-link.active {
        background-color: rgba(123, 44, 191, 0.2);
        color: var(--primary-color);
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #2d2d2d;
    }

    ::-webkit-scrollbar-thumb {
        background: #555;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #777;
    }

    /* Ensure dropdown menus are visible */
    .dropdown-menu {
        z-index: 9999 !important;
        position: absolute !important;
    }

    .dropdown.show .dropdown-menu {
        display: block !important;
    }
</style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartHire AI - {% block title %}{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Add these in the head section -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Navigation - Show for all authenticated users except employee pages -->
    {% if 'user_id' in session and not request.path.startswith('/employee/') %}
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <!-- User Info -->
            <div class="d-flex align-items-center text-light me-3">
                <i class="fas fa-user-circle me-2"></i>
                <div>
                    <div class="fw-bold">{{ user.full_name if user else 'User' }}</div>
                    <small class="text-light-50">{{ user.role|title if user else 'User' }}</small>
                </div>
            </div>
            <a class="navbar-brand" href="{{ url_for('index') }}">SmartHire AI</a>
            <div class="ms-auto"></div>
            <div class="d-flex align-items-center">
                <!-- Notification Dropdown -->
                <div class="nav-item dropdown me-3">
                    <a class="nav-link dropdown-toggle text-light position-relative" href="#" id="hrNotificationDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-bell"></i>
                        <span id="hrNotificationBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none; font-size: 0.6em;">0</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="hrNotificationDropdown">
                        <li><h6 class="dropdown-header">HR Notifications</h6></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="loadHRNotifications(); return false;">View All Notifications</a></li>
                        <li><a class="dropdown-item" href="#" onclick="generateDailySummary(); return false;">Generate Daily Summary</a></li>
                    </ul>
                </div>
                <span class="text-light me-3 d-none d-md-inline">{{ session.get('username', 'User') }}</span>
                <a href="{{ url_for('logout') }}" class="btn btn-outline-light" title="Logout">
                    <i class="fas fa-sign-out-alt me-1"></i> <span class="d-none d-md-inline">Logout</span>
                </a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <!-- Core Navigation -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="coreDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-house-door"></i> Core
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="coreDropdown">
                            <li><a class="dropdown-item" href="{{ url_for('index') }}">Dashboard</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('list_employees') }}">Employees</a></li>
                        </ul>
                    </li>
                    
                    <!-- Employee Lifecycle -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle {% if request.path in [url_for('onboarding'), url_for('pre_onboarding'), url_for('knowledge_transfer')] %}active{% endif %}" href="#" id="lifecycleDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-person-plus"></i> Lifecycle
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="lifecycleDropdown">
                            <li><a class="dropdown-item" href="{{ url_for('pre_onboarding') }}">Pre-Onboarding</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('onboarding') }}">Onboarding</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('exit_interview') }}">Offboarding</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('knowledge_transfer') }}">Knowledge Transfer</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('goal_setting') }}">Goal Setting</a></li>
                        </ul>
                    </li>
                    
                    <!-- AI Tools -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle {% if request.path == url_for('interview') %}active{% endif %}" href="#" id="aiDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-robot"></i> AI Tools
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="aiDropdown">
                            <li><a class="dropdown-item" href="{{ url_for('interview') }}">AI Interviews</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('ai_interview_training') }}">Interview Training</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('mood_analytics') }}">Mood Analytics</a></li>
                        </ul>
                    </li>
                    
                    <!-- More Tools (Collapsible) -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="moreDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-three-dots"></i> More
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="moreDropdown">
                            <li><h6 class="dropdown-header">Communication</h6></li>
                            <li><a class="dropdown-item" href="{{ url_for('messages_management') }}">Messages</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('social_integration') }}">Social Integration</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><h6 class="dropdown-header">Management</h6></li>
                            <li><a class="dropdown-item" href="{{ url_for('tasks_management') }}">Tasks</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('alumni_network') }}">Alumni Network</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('access_records_management') }}">Access Records</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    {% endif %}

    <!-- Main Content -->
    <main class="container my-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="mt-auto">
        <div class="container">
            <div class="footer-content">

                <div class="copyright">
                    &copy; 2025 SmartHire AI. All rights reserved.
                </div>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <a href="#" class="back-to-top" id="backToTop" title="Go to top">
        <i class="bi bi-arrow-up"></i>
    </a>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    {% if user and user.role == 'hr' %}
    <script src="{{ url_for('static', filename='js/hr-notifications.js') }}"></script>
    {% endif %}
    
    <!-- Back to Top Button Script -->
    <script>
        // Back to top button
        const backToTopButton = document.getElementById('backToTop');
        
        // Show/hide the button based on scroll position
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                backToTopButton.classList.add('visible');
            } else {
                backToTopButton.classList.remove('visible');
            }
        });
        
        // Smooth scroll to top when clicked
        backToTopButton.addEventListener('click', function(e) {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
    </script>
    
    {% block extra_js %}{% endblock %}
    
    <!-- Toast Container for HR Notifications -->
    <div id="toastContainer" class="position-fixed top-0 end-0 p-3" style="z-index: 9999;"></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Apply dark theme by default
            document.documentElement.setAttribute('data-bs-theme', 'dark');
            
            // Save preference to localStorage
            localStorage.setItem('theme', 'dark');
            
            // Initialize tooltips and popovers
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
            
            // Initialize modals
            var modalList = [].slice.call(document.querySelectorAll('.modal'));
            modalList.forEach(function(modalEl) {
                // Only initialize if not already initialized
                if (!modalEl._modal) {
                    modalEl._modal = new bootstrap.Modal(modalEl, {
                        backdrop: true,
                        keyboard: true
                    });
                }
            });
            
            // Store Bootstrap instance for later use
            window.bootstrap = bootstrap;
        });
    </script>
</body>
</html>
